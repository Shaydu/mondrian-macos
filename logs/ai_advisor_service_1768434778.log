[INFO] Python executable: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[INFO] Python version: 3.12.2
[INFO] Working directory: /Users/shaydu/dev/mondrian-macos
[INFO] Environment variables:
[INFO]   MLX_USE_CPU=<not set>
[INFO]   CUDA_VISIBLE_DEVICES=<not set>
[INFO]   PYTORCH_ENABLE_MPS_FALLBACK=<not set>
[INFO] MLX default device explicitly set to: Device(gpu, 0)
[INFO] MLX configured to use GPU backend (Metal)
[INFO] MLX backend initialized successfully (GPU mode)
[INFO] AI Advisor Service v2.0-JSON starting...
[INFO] Using JSON output format (converted to HTML for backward compatibility)
[INFO] Using base64 encoding for all images
[INFO] Using MLX backend for vision analysis
[INFO] MLX Mode: ENABLED
[INFO] MLX Model: mlx-community/Qwen3-VL-4B-Instruct-4bit
[INFO] Model timeout: 300s
[INFO] RAG Service URL: http://127.0.0.1:5400
[INFO] RAG Default: ENABLED (from RAG_ENABLED env var)
[INFO] System prompt loaded from database (2751 characters)
AI Advisor Service starting up...
  Port: 5100
  DB Path: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
  MLX Model: mlx-community/Qwen3-VL-4B-Instruct-4bit
  Job service URL: http://127.0.0.1:5005
  Current working directory: /Users/shaydu/dev/mondrian-macos
  Image Encoding: BASE64 (all platforms)
[INFO] Initializing service with model_mode=fine_tuned
[INFO] Model Strategy: FINE-TUNED
[INFO] Loading LoRA adapter from: ./adapters/ansel
[INFO] Loading MLX model: mlx-community/Qwen3-VL-4B-Instruct-4bit...
[INFO] Testing Metal GPU access...
[INFO] âœ“ Metal GPU is available and working
Fetching 14 files:   0%|          | 0/14 [00:00<?, ?it/s]Fetching 14 files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [00:00<00:00, 130780.08it/s]
[INFO] MLX model loaded in 4.11s using GPU backend and cached
[INFO] MLX default device: Device(gpu, 0)
[INFO] âœ“ GPU acceleration confirmed active
[INFO] Loading LoRA adapter from: ./adapters/ansel
[INFO] LoRA Config: rank=None, alpha=None, dropout=None
[INFO] Applying LoRA adapter from: ./adapters/ansel
#trainable params: 16.515072 M || all params: 4022.468096 M || trainable%: 0.411%
[INFO] LoRA adapter successfully applied to model
[INFO] Service initialized successfully. Fine-tuned: True
[INFO] Model Strategy: fine_tuned
[INFO] Fine-Tuned: True
[INFO] Service ready on http://0.0.0.0:5100
AI Advisor Service running on port 5100...
 * Serving Flask app 'ai_advisor_service'
 * Debug mode: off
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5100
 * Running on http://10.0.0.131:5100
[33mPress CTRL+C to quit[0m
127.0.0.1 - - [14/Jan/2026 16:53:12] "GET /model-status HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:32] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:53:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:54:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:00] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:45] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:55:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:06] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:11] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:16] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:36] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:41] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:51] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:56:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:06] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:11] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:16] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:32] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:57:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:02] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:32] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:58:58] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:34] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 16:59:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:04] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:24] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:29] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:34] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:45] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:00:55] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:00] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:45] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:01:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:06] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:11] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:16] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:36] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:02:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:02] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:03:58] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:29] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:34] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:04:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 17:05:30] "GET /health HTTP/1.1" 200 -
