[INFO] Job Service v2.3-DB-FIXED starting...
[INFO] Database connection management fixed for real-time status updates
[INIT] AI_SERVICE_URL: http://127.0.0.1:5100/analyze
[INIT] Port: 5005
[INIT] Database: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
[INIT] Debug mode: False
[INIT] Created directories
[INIT] Initializing database...
[INIT] Database schema OK
[INIT] RAG Default: ENABLED (from RAG_ENABLED env var)
============================================================
Starting Job Service v2.3-DB-FIXED on port 5005...
Host: 0.0.0.0:5005
AI Service: http://127.0.0.1:5100/analyze
============================================================
 * Serving Flask app 'job_service_v2.3'
 * Debug mode: off
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5005
 * Running on http://10.0.0.131:5005
[33mPress CTRL+C to quit[0m
127.0.0.1 - - [14/Jan/2026 18:26:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:38] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:27:43] "GET /advisors HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:27:58] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:28:01] "[35m[1mPOST /upload HTTP/1.1[0m" 201 -
10.0.0.152 - - [14/Jan/2026 18:28:02] "GET /stream/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:28:02] "GET /status/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:28:02] "PUT /job/035247a6-ad9e-4c57-8312-3b99d98759fc/thinking HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:28:02] "PUT /job/035247a6-ad9e-4c57-8312-3b99d98759fc/thinking HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:24] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:29] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:28:33] "GET /status/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:34] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:28:55] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:00] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:29:03] "GET /status/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:31] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:29:32] "GET /status/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:29:35] "GET /summary/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:29:35] "GET /summary/035247a6-ad9e-4c57-8312-3b99d98759fc%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:36] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:29:37] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:41] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:51] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:29:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:30:58] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:24] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:29] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:34] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:31:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:36] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:41] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:32:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:02] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:32] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:33:58] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:44] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:34:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:04] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:24] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:29] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:45] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:35:55] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:00] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:05] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:36:08] "GET /advisors HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:16] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:36] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:41] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:51] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:36:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:01] "GET /health HTTP/1.1" 200 -
[UPLOAD] enable_rag parameter from request: 'true' â†’ True
[UPLOAD] âœ“ Final enable_rag value: True (will be stored in database and passed to AI service)
[UPLOAD] Mode derived from enable_rag: 'rag'
[UPLOAD] âœ“ Final mode value: rag (will be stored in database and passed to AI service)
[UPLOAD] ========== JOB QUEUED ==========
[UPLOAD] Job ID: 035247a6-ad9e-4c57-8312-3b99d98759fc
[UPLOAD] Mode: rag
[UPLOAD] Enable RAG: True
[UPLOAD] Advisors: ['ansel']
[UPLOAD] =====================================

================================================================================
[JOB] ========== PROCESS_JOB STARTED ==========
[JOB] Job ID: 035247a6-ad9e-4c57-8312-3b99d98759fc
[JOB] Filename: photo-71BCBC68-4107-4BF6-82BB-CA68C2329B30-8e2fc69c.jpg
[JOB] Advisors: ['ansel']
[JOB] Mode: rag
[JOB] Enable RAG: True
[JOB] Host URL: http://10.0.0.131:5005
[JOB] Flow: RAG + DEFAULT MODEL
[JOB] ====================================
================================================================================

[JOB] Setting status to processing for job 035247a6-ad9e-4c57-8312-3b99d98759fc
[JOB] Checking source path: /Users/shaydu/dev/mondrian-macos/source/photo-71BCBC68-4107-4BF6-82BB-CA68C2329B30-8e2fc69c.jpg
[INFO] Resized image for display: photo-71BCBC68-4107-4BF6-82BB-CA68C2329B30-8e2fc69c.jpg (4032x3024 -> 1320x990)
[JOB] Generated optimized image: /Users/shaydu/dev/mondrian-macos/thumbnails/photo-71BCBC68-4107-4BF6-82BB-CA68C2329B30-8e2fc69c.jpg
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[JOB] Calling AI service for advisor ansel: http://127.0.0.1:5100/analyze
[JOB] âœ“ Sending request to AI service with mode='rag', enable_rag='true' (boolean: True)
[JOB] Full request data: {'advisor': 'ansel', 'job_id': '035247a6-ad9e-4c57-8312-3b99d98759fc', 'job_service_url': 'http://10.0.0.131:5005', 'enable_rag': 'true', 'mode': 'rag'}
[JOB] AI service response status: 200
[DEBUG] Response content-type: application/json
[JOB] Received JSON response for ansel:
[JOB]   HTML length: 8325 characters
[JOB]   Mode used: rag
[JOB]   Metadata: {'mode_used': 'rag', 'requested_mode': 'rag', 'effective_mode': 'rag', 'fallback_occurred': False, 'overall_grade': 'B-', 'advisor_id': 'ansel'}
[JOB] Completed advisor ansel (1/1)
[JOB] All advisors processed (1/1)
[DEBUG] Extracting recommendations for advisor: ansel
[DEBUG] Extracted HTML from new JSON format for ansel
[DEBUG] Found 5 feedback cards for ansel
[DEBUG] Added recommendation for Composition: score=8.0, has_rec=True
[DEBUG] Added recommendation for Lighting: score=7.0, has_rec=True
[DEBUG] Added recommendation for Color Harmony: score=6.0, has_rec=True
[DEBUG] Added recommendation for Visual Balance: score=8.0, has_rec=True
[DEBUG] Added recommendation for Emotional Impact: score=7.0, has_rec=True
[DEBUG] RAG mode: User profile not found, falling back to score-based sorting
[DEBUG] Extracted 3 recommendations for ansel
[DEBUG] Job 035247a6-ad9e-4c57-8312-3b99d98759fc completed
[DEBUG] Parsing critical_recommendations for job 035247a6-ad9e-4c57-8312-3b99d98759fc (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading adjustment to soften the sky tones and enhance the natural transition from orange to yellow, preserving the emotional impact.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for the shadows to reveal more texture and depth in the foreground, preserving the Zone System's full tonal range.", "dimension_score": 7.0}, {"dimensi
[DEBUG] Parsing critical_recommendations for job 035247a6-ad9e-4c57-8312-3b99d98759fc (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading adjustment to soften the sky tones and enhance the natural transition from orange to yellow, preserving the emotional impact.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for the shadows to reveal more texture and depth in the foreground, preserving the Zone System's full tonal range.", "dimension_score": 7.0}, {"dimensi
[OK] Serving advisor image: ansel (673547 bytes)
[UPLOAD] enable_rag parameter from request: 'true' â†’ True
[UPLOAD] âœ“ Final enable_rag value: True (will be stored in database and passed to AI service)
[UPLOAD] Mode derived from enable_rag: 'rag'
[UPLOAD] âœ“ Final mode value: rag (will be stored in database and passed to AI service)
[UPLOAD] ========== JOB QUEUED ==========
[UPLOAD] Job ID: 3e8dee0a-04b0-47f8-af57-b6fcad09a102
[UPLOAD] Mode: rag
[UPLOAD] Enable RAG: True
[UPLOAD] Advisors: ['ansel']
[UPLOAD] =====================================

================================================================================
10.0.0.152 - - [14/Jan/2026 18:37:06] "[35m[1mPOST /upload HTTP/1.1[0m" 201 -
10.0.0.152 - - [14/Jan/2026 18:37:06] "GET /stream/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:37:06] "GET /status/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:37:07] "PUT /job/3e8dee0a-04b0-47f8-af57-b6fcad09a102/thinking HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:37:07] "PUT /job/3e8dee0a-04b0-47f8-af57-b6fcad09a102/thinking HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:33] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:37:38] "GET /status/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:37:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:04] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:38:07] "GET /status/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:15] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:35] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:38:36] "GET /summary/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:38:36] "GET /summary/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:38:39] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:51] "GET /health HTTP/1.1" 200 -
[JOB] ========== PROCESS_JOB STARTED ==========
[JOB] Job ID: 3e8dee0a-04b0-47f8-af57-b6fcad09a102
[JOB] Filename: photo-D0432958-7E3F-4C3D-945F-72643BC38151-93f3eb27.jpg
[JOB] Advisors: ['ansel']
[JOB] Mode: rag
[JOB] Enable RAG: True
[JOB] Host URL: http://10.0.0.131:5005
[JOB] Flow: RAG + DEFAULT MODEL
[JOB] ====================================
================================================================================

[JOB] Setting status to processing for job 3e8dee0a-04b0-47f8-af57-b6fcad09a102
[JOB] Checking source path: /Users/shaydu/dev/mondrian-macos/source/photo-D0432958-7E3F-4C3D-945F-72643BC38151-93f3eb27.jpg
[INFO] Resized image for display: photo-D0432958-7E3F-4C3D-945F-72643BC38151-93f3eb27.jpg (4032x3024 -> 1320x990)
[JOB] Generated optimized image: /Users/shaydu/dev/mondrian-macos/thumbnails/photo-D0432958-7E3F-4C3D-945F-72643BC38151-93f3eb27.jpg
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[JOB] Calling AI service for advisor ansel: http://127.0.0.1:5100/analyze
[JOB] âœ“ Sending request to AI service with mode='rag', enable_rag='true' (boolean: True)
[JOB] Full request data: {'advisor': 'ansel', 'job_id': '3e8dee0a-04b0-47f8-af57-b6fcad09a102', 'job_service_url': 'http://10.0.0.131:5005', 'enable_rag': 'true', 'mode': 'rag'}
[JOB] AI service response status: 200
[DEBUG] Response content-type: application/json
[JOB] Received JSON response for ansel:
[JOB]   HTML length: 8325 characters
[JOB]   Mode used: rag
[JOB]   Metadata: {'mode_used': 'rag', 'requested_mode': 'rag', 'effective_mode': 'rag', 'fallback_occurred': False, 'overall_grade': 'B-', 'advisor_id': 'ansel'}
[JOB] Completed advisor ansel (1/1)
[JOB] All advisors processed (1/1)
[DEBUG] Extracting recommendations for advisor: ansel
[DEBUG] Extracted HTML from new JSON format for ansel
[DEBUG] Found 5 feedback cards for ansel
[DEBUG] Added recommendation for Composition: score=8.0, has_rec=True
[DEBUG] Added recommendation for Lighting: score=7.0, has_rec=True
[DEBUG] Added recommendation for Color Harmony: score=6.0, has_rec=True
[DEBUG] Added recommendation for Visual Balance: score=8.0, has_rec=True
[DEBUG] Added recommendation for Emotional Impact: score=7.0, has_rec=True
[DEBUG] RAG mode: User profile not found, falling back to score-based sorting
[DEBUG] Extracted 3 recommendations for ansel
[DEBUG] Job 3e8dee0a-04b0-47f8-af57-b6fcad09a102 completed
[DEBUG] Parsing critical_recommendations for job 3e8dee0a-04b0-47f8-af57-b6fcad09a102 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading adjustment to soften the sky tones and enhance the natural transition from orange to yellow, preserving the emotional impact.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for the shadows to reveal more texture and depth in the foreground, preserving the Zone System's full tonal range.", "dimension_score": 7.0}, {"dimensi
[DEBUG] Parsing critical_recommendations for job 3e8dee0a-04b0-47f8-af57-b6fcad09a102 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading adjustment to soften the sky tones and enhance the natural transition from orange to yellow, preserving the emotional impact.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for the shadows to reveal more texture and depth in the foreground, preserving the Zone System's full tonal range.", "dimension_score": 7.0}, {"dimensi
[OK] Serving advisor image: ansel (673547 bytes)
[DEBUG] /analysis endpoint: Getting advisor info for 'ansel', DB_PATH: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
10.0.0.152 - - [14/Jan/2026 18:38:51] "GET /analysis/3e8dee0a-04b0-47f8-af57-b6fcad09a102%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:38:56] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:39:00] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:06] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:11] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:32] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:42] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:39:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:02] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:40:03] "GET /advisors HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:18] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:40:19] "GET /advisors HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:48] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:40:50] "[35m[1mPOST /upload HTTP/1.1[0m" 201 -
10.0.0.152 - - [14/Jan/2026 18:40:51] "GET /stream/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:40:51] "GET /status/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[DEBUG] /analysis endpoint: Advisor info retrieved - True
[OK] Serving advisor image: ansel (673547 bytes)
[UPLOAD] enable_rag parameter from request: 'true' â†’ True
[UPLOAD] âœ“ Final enable_rag value: True (will be stored in database and passed to AI service)
[UPLOAD] Mode derived from enable_rag: 'rag'
[UPLOAD] âœ“ Final mode value: rag (will be stored in database and passed to AI service)
[UPLOAD] ========== JOB QUEUED ==========
[UPLOAD] Job ID: dba6ce7e-15a4-418e-bc58-7a22d8582cd2
[UPLOAD] Mode: rag
[UPLOAD] Enable RAG: True
[UPLOAD] Advisors: ['ansel']
[UPLOAD] =====================================

================================================================================
[JOB] ========== PROCESS_JOB STARTED ==========
[JOB] Job ID: dba6ce7e-15a4-418e-bc58-7a22d8582cd2
[JOB] Filename: photo-146CD755-7B50-47A4-BE0F-4F29AC932D42-15b04a6c.jpg
[JOB] Advisors: ['ansel']
[JOB] Mode: rag
[JOB] Enable RAG: True
[JOB] Host URL: http://10.0.0.131:5005
[JOB] Flow: RAG + DEFAULT MODEL
[JOB] ====================================
================================================================================

[JOB] Setting status to processing for job dba6ce7e-15a4-418e-bc58-7a22d8582cd2
[JOB] Checking source path: /Users/shaydu/dev/mondrian-macos/source/photo-146CD755-7B50-47A4-BE0F-4F29AC932D42-15b04a6c.jpg
[INFO] Resized image for display: photo-146CD755-7B50-47A4-BE0F-4F29AC932D42-15b04a6c.jpg (4032x3024 -> 1320x990)
[JOB] Generated optimized image: /Users/shaydu/dev/mondrian-macos/thumbnails/photo-146CD755-7B50-47A4-BE0F-4F29AC932D42-15b04a6c.jpg
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
10.0.0.131 - - [14/Jan/2026 18:40:52] "PUT /job/dba6ce7e-15a4-418e-bc58-7a22d8582cd2/thinking HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:40:52] "PUT /job/dba6ce7e-15a4-418e-bc58-7a22d8582cd2/thinking HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:40:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:04] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:20] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:41:22] "GET /status/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:46] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:51] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:41:52] "GET /status/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:41:56] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:12] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:42:13] "GET /summary/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:42:13] "GET /summary/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:42:15] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:22] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:27] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:38] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:53] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:42:58] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:03] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:08] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:13] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:39] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:44] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:43:44] "GET /analysis/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:49] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:43:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:04] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:40] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:45] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:44:55] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:01] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:06] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:11] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:16] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:21] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:26] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:36] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:41] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:45:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:02] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:12] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:17] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:38] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:46:39] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:43] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:48] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:46:59] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:04] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:09] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:14] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:19] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:24] "GET /health HTTP/1.1" 200 -
[JOB] Calling AI service for advisor ansel: http://127.0.0.1:5100/analyze
[JOB] âœ“ Sending request to AI service with mode='rag', enable_rag='true' (boolean: True)
[JOB] Full request data: {'advisor': 'ansel', 'job_id': 'dba6ce7e-15a4-418e-bc58-7a22d8582cd2', 'job_service_url': 'http://10.0.0.131:5005', 'enable_rag': 'true', 'mode': 'rag'}
[JOB] AI service response status: 200
[DEBUG] Response content-type: application/json
[JOB] Received JSON response for ansel:
[JOB]   HTML length: 8310 characters
[JOB]   Mode used: rag
[JOB]   Metadata: {'mode_used': 'rag', 'requested_mode': 'rag', 'effective_mode': 'rag', 'fallback_occurred': False, 'overall_grade': 'B-', 'advisor_id': 'ansel'}
[JOB] Completed advisor ansel (1/1)
[JOB] All advisors processed (1/1)
[DEBUG] Extracting recommendations for advisor: ansel
[DEBUG] Extracted HTML from new JSON format for ansel
[DEBUG] Found 5 feedback cards for ansel
[DEBUG] Added recommendation for Composition: score=8.0, has_rec=True
[DEBUG] Added recommendation for Lighting: score=7.0, has_rec=True
[DEBUG] Added recommendation for Color Harmony: score=6.0, has_rec=True
[DEBUG] Added recommendation for Visual Balance: score=8.0, has_rec=True
[DEBUG] Added recommendation for Emotional Impact: score=7.0, has_rec=True
[DEBUG] RAG mode: User profile not found, falling back to score-based sorting
[DEBUG] Extracted 3 recommendations for ansel
[DEBUG] Job dba6ce7e-15a4-418e-bc58-7a22d8582cd2 completed
[DEBUG] Parsing critical_recommendations for job dba6ce7e-15a4-418e-bc58-7a22d8582cd2 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading to deepen the shadows and enhance the vibrancy of the foreground rocks, creating a more balanced tonal contrast.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for shadows to reveal more texture in the foreground rocks and vegetation, enhancing the tactile quality of the scene.", "dimension_score": 7.0}, {"dimension": "Emo
[DEBUG] Parsing critical_recommendations for job dba6ce7e-15a4-418e-bc58-7a22d8582cd2 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading to deepen the shadows and enhance the vibrancy of the foreground rocks, creating a more balanced tonal contrast.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for shadows to reveal more texture in the foreground rocks and vegetation, enhancing the tactile quality of the scene.", "dimension_score": 7.0}, {"dimension": "Emo
[OK] Serving advisor image: ansel (673547 bytes)
[DEBUG] /analysis endpoint: Getting advisor info for 'ansel', DB_PATH: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[DEBUG] /analysis endpoint: Advisor info retrieved - True
[OK] Serving advisor image: ansel (673547 bytes)
[DEBUG] /analysis endpoint: Getting advisor info for 'ansel', DB_PATH: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
10.0.0.152 - - [14/Jan/2026 18:47:26] "GET /analysis/dba6ce7e-15a4-418e-bc58-7a22d8582cd2%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:30] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:35] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:40] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:47:45] "[35m[1mPOST /upload HTTP/1.1[0m" 201 -
127.0.0.1 - - [14/Jan/2026 18:47:45] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:47:45] "GET /stream/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:47:45] "GET /status/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[DEBUG] /analysis endpoint: Advisor info retrieved - True
[UPLOAD] enable_rag parameter from request: 'true' â†’ True
[UPLOAD] âœ“ Final enable_rag value: True (will be stored in database and passed to AI service)
[UPLOAD] Mode derived from enable_rag: 'rag'
[UPLOAD] âœ“ Final mode value: rag (will be stored in database and passed to AI service)
[UPLOAD] ========== JOB QUEUED ==========
[UPLOAD] Job ID: 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0
[UPLOAD] Mode: rag
[UPLOAD] Enable RAG: True
[UPLOAD] Advisors: ['ansel']
[UPLOAD] =====================================

================================================================================
[JOB] ========== PROCESS_JOB STARTED ==========
[JOB] Job ID: 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0
[JOB] Filename: photo-A003C00A-ECED-4B3D-91A7-9EB35A9E1700-6241263e.jpg
[JOB] Advisors: ['ansel']
[JOB] Mode: rag
[JOB] Enable RAG: True
[JOB] Host URL: http://10.0.0.131:5005
[JOB] Flow: RAG + DEFAULT MODEL
[JOB] ====================================
================================================================================

[JOB] Setting status to processing for job 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0
[JOB] Checking source path: /Users/shaydu/dev/mondrian-macos/source/photo-A003C00A-ECED-4B3D-91A7-9EB35A9E1700-6241263e.jpg
[INFO] Resized image for display: photo-A003C00A-ECED-4B3D-91A7-9EB35A9E1700-6241263e.jpg (4032x3024 -> 1320x990)
[JOB] Generated optimized image: /Users/shaydu/dev/mondrian-macos/thumbnails/photo-A003C00A-ECED-4B3D-91A7-9EB35A9E1700-6241263e.jpg
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[JOB] Calling AI service for advisor ansel: http://127.0.0.1:5100/analyze
10.0.0.131 - - [14/Jan/2026 18:47:45] "PUT /job/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0/thinking HTTP/1.1" 200 -
10.0.0.131 - - [14/Jan/2026 18:47:45] "PUT /job/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0/thinking HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:50] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:47:55] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:00] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:05] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:10] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:15] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:48:15] "GET /status/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:20] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:25] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:31] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:37] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:42] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:48:46] "GET /status/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:47] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:52] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:48:57] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:02] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:07] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:12] "GET /health HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:49:13] "GET /summary/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:49:13] "GET /summary/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:49:13] "GET /advisor_image/ansel.jpg HTTP/1.1" 200 -
10.0.0.152 - - [14/Jan/2026 18:49:17] "GET /analysis/94802e3e-b1dc-4d46-85a8-f07e5dcb22b0%20(rag) HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:18] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:23] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:28] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:33] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [14/Jan/2026 18:49:38] "GET /health HTTP/1.1" 200 -
[JOB] âœ“ Sending request to AI service with mode='rag', enable_rag='true' (boolean: True)
[JOB] Full request data: {'advisor': 'ansel', 'job_id': '94802e3e-b1dc-4d46-85a8-f07e5dcb22b0', 'job_service_url': 'http://10.0.0.131:5005', 'enable_rag': 'true', 'mode': 'rag'}
[JOB] AI service response status: 200
[DEBUG] Response content-type: application/json
[JOB] Received JSON response for ansel:
[JOB]   HTML length: 8356 characters
[JOB]   Mode used: rag
[JOB]   Metadata: {'mode_used': 'rag', 'requested_mode': 'rag', 'effective_mode': 'rag', 'fallback_occurred': False, 'overall_grade': 'B-', 'advisor_id': 'ansel'}
[JOB] Completed advisor ansel (1/1)
[JOB] All advisors processed (1/1)
[DEBUG] Extracting recommendations for advisor: ansel
[DEBUG] Extracted HTML from new JSON format for ansel
[DEBUG] Found 5 feedback cards for ansel
[DEBUG] Added recommendation for Composition: score=8.0, has_rec=True
[DEBUG] Added recommendation for Lighting: score=7.0, has_rec=True
[DEBUG] Added recommendation for Color Harmony: score=6.0, has_rec=True
[DEBUG] Added recommendation for Visual Balance: score=8.0, has_rec=True
[DEBUG] Added recommendation for Emotional Impact: score=7.0, has_rec=True
[DEBUG] RAG mode: User profile not found, falling back to score-based sorting
[DEBUG] Extracted 3 recommendations for ansel
[DEBUG] Job 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0 completed
[DEBUG] Parsing critical_recommendations for job 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading to blend the warm and cool tones, especially in the sky and foreground, to create a more harmonious transition.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for shadows to reveal more texture in the foreground, especially in the dirt path and grasses.", "dimension_score": 7.0}, {"dimension": "Emotional Impact", "comment"
[DEBUG] Parsing critical_recommendations for job 94802e3e-b1dc-4d46-85a8-f07e5dcb22b0 (rag)
[DEBUG] critical_recommendations value: {"ansel": [{"dimension": "Color Harmony", "comment": "", "recommendation": "Apply a subtle color grading to blend the warm and cool tones, especially in the sky and foreground, to create a more harmonious transition.", "dimension_score": 6.0}, {"dimension": "Lighting", "comment": "", "recommendation": "Increase exposure compensation for shadows to reveal more texture in the foreground, especially in the dirt path and grasses.", "dimension_score": 7.0}, {"dimension": "Emotional Impact", "comment"
[OK] Serving advisor image: ansel (673547 bytes)
[DEBUG] /analysis endpoint: Getting advisor info for 'ansel', DB_PATH: /Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db
[DEBUG] get_advisor_from_db called with db_path=/Users/shaydu/dev/mondrian-macos/mondrian/mondrian.db, advisor_id=ansel
[DEBUG] raw row fetched for advisor_id=ansel: ('ansel', 'Ansel Adams', 'Ansel Adams (1902-1984) was an American landscape photographer and environmentalist known for his black-and-white images of the American West, especially Yosemite National Park. He helped found the photography group f/64, developed the Zone System for achieving perfect exposure and tonal range, and was a pioneering advocate for environmental conservation through his art.', '1902-1984', "You are Ansel Adams, master of black-and-white landscape photography. You revolutionized photography through your Zone System, which gave photographers unprecedented control over exposure and tonal range.\n\nYour approach to evaluating an image:\n\n1. **Tonal Range & Zone System** - Analyze the full spectrum from Zone 0 (pure black) to Zone X (pure white). Look for:\n   - Rich blacks with detail in shadows (Zones II-III)\n   - Pure whites that aren't blown out (Zone VIII-IX)\n   - Full midtone gradation (Zones IV-VI)\n   - Proper exposure that preserves detail across the entire tonal range\n\n2. **Composition & Perspective** - Examine the geometric structure:\n   - Leading lines that draw the eye through the frame\n   - Rule of thirds and golden ratio placement\n   - Foreground, midground, and background layering\n   - Balance between elements\n   - Use of natural frames\n\n3. **Technical Excellence** - Assess the craft:\n   - Critical sharpness and focus (f/64 philosophy)\n   - Depth of field appropriate to the subject\n   - Proper exposure (not too dark, not too light)\n   - Clean, well-printed negative equivalent\n\n4. **Light & Shadow** - Evaluate the interplay:\n   - Direction and quality of light\n   - Dramatic use of shadows to create depth\n   - Texture revealed through sidelight\n   - Time of day considerations (golden hour, blue hour)\n\n5. **Emotional Impact** - Consider the feeling:\n   - Sense of scale and majesty\n   - Connection to the natural world\n   - Drama and atmosphere\n   - Timeless quality\n\nWhen providing feedback, be specific and constructive. Reference the Zone System and technical aspects while also addressing the emotional impact. Encourage the photographer to see beyond the literal and capture the feeling of being present in that moment.", '[{"title": "Tonal Range & Zone System", "description": "Master of the full spectrum from pure black to pure white, using his Zone System to achieve perfect exposure and tonal gradation in every image."}, {"title": "Composition & Perspective", "description": "Precise framing that emphasizes geometric elements, leading lines, and careful positioning to create powerful visual impact."}, {"title": "Technical Excellence", "description": "Perfect sharpness, focus, and exposure achieved through large-format cameras and meticulous darkroom work."}, {"title": "Landscape Drama", "description": "Captures the majesty and drama of natural landscapes with emphasis on light, shadow, and texture."}]', 'Photographer', 'https://en.wikipedia.org/wiki/Ansel_Adams', 'https://commons.wikimedia.org/wiki/Category:Ansel_Adams', 'baseline') (cols: ['id', 'name', 'bio', 'years', 'prompt', 'focus_areas', 'category', 'wikipedia_url', 'commons_url', 'prompt_type'])
[DEBUG] /analysis endpoint: Advisor info retrieved - True
