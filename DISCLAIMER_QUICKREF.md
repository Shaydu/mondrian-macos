# Disclaimer Centralization - Quick Reference

## What Changed

The AI analysis disclaimer is now stored in the database `config` table instead of being hardcoded in multiple places. This makes it easy to change the disclaimer globally.

## Files Modified

| File | Change |
|------|--------|
| `mondrian/export_service_linux.py` | Added `get_disclaimer_text()` function; modified `generate_consolidated_export_html()` to fetch disclaimer from database |
| `mondrian/ai_advisor_service_linux.py` | Added `get_disclaimer_text()` function; modified `_generate_summary_html()` to fetch disclaimer from database |
| `init_database.py` | Added seeding of default disclaimer in config table on database initialization |
| `update_disclaimer.py` | **NEW** - Utility script to view and update disclaimer in database |
| `DISCLAIMER_CONFIG.md` | **NEW** - Comprehensive guide for managing disclaimers |

## How to Use

### View Current Disclaimer
```bash
source venv/bin/activate
python3 update_disclaimer.py --show
```

### Update Disclaimer
```bash
# Edit the DEFAULT_DISCLAIMER variable
nano update_disclaimer.py

# Then apply the change
source venv/bin/activate
python3 update_disclaimer.py
```

### Edit Directly in Database
```bash
sqlite3 mondrian.db
UPDATE config SET value='Your new disclaimer text' WHERE key='disclaimer';
.quit
```

## Locations in Output

**PDF Export Footer:**
- Shows full multi-paragraph disclaimer
- Format: HTML with `<p>` tags
- Updated from: `mondrian/export_service_linux.py`

**Analysis Summary HTML:**
- Shows short disclaimer in note paragraph
- Format: HTML in `<p>` tag
- Updated from: `mondrian/ai_advisor_service_linux.py`

## Default Disclaimer

```
AI-Generated Analysis: This report is generated by artificial intelligence and represents a simulated perspective of the named advisor. It is not a professional critique from an actual photographer or art expert.

Creative Guidance Only: These recommendations should be used as creative guidance and inspiration, not as definitive professional advice. Individual artistic interpretation and personal vision may vary.

Not Professional Advice: This analysis is not a substitute for professional photography instruction, mentorship, or critique. For professional assessment, consult with qualified photography educators or critics.
```

## Key Benefits

✓ **Single Source of Truth** - One place to change disclaimer text
✓ **Automatic Updates** - Changes apply to all exports immediately
✓ **No Code Restart Needed** - Can update without restarting services (next export uses new text)
✓ **Database Backed** - Persists across restarts
✓ **Fallback Support** - Works even if database access fails

## Database Schema

The disclaimer is stored in the existing `config` table:

```sql
-- View current disclaimer
SELECT value FROM config WHERE key='disclaimer';

-- Update disclaimer
UPDATE config SET value='New text' WHERE key='disclaimer';

-- Check if disclaimer exists
SELECT COUNT(*) FROM config WHERE key='disclaimer';
```

## Installation/Setup

### For New Databases
The disclaimer is automatically seeded when you run:
```bash
python3 init_database.py
```

### For Existing Databases
Run the update script to add the disclaimer:
```bash
source venv/bin/activate
python3 update_disclaimer.py
```

## Testing

### Verify in PDF Export
```bash
source venv/bin/activate
curl http://localhost:5007/export/<job_id> | grep -i "disclaimer"
```

### Verify in Analysis Summary
```bash
curl http://localhost:5005/jobs/<job_id> | grep -i "disclaimer"
```

## Troubleshooting

**Disclaimer not appearing:**
1. Verify it exists: `sqlite3 mondrian.db "SELECT * FROM config WHERE key='disclaimer';"`
2. If empty, run: `python3 update_disclaimer.py`
3. Restart the service to pick up changes

**Changes not appearing:**
1. Services cache results for performance
2. Restart export service: `pkill -f export_service_linux.py`
3. Next export will use new disclaimer

**Database error:**
1. Check database exists: `ls -l mondrian.db`
2. Check config table: `sqlite3 mondrian.db "SELECT * FROM config;"`
3. Reinitialize if needed: `python3 init_database.py`

## See Also

- [DISCLAIMER_CONFIG.md](DISCLAIMER_CONFIG.md) - Full configuration guide
- [PDF_EXPORT_SETUP.md](PDF_EXPORT_SETUP.md) - PDF export setup
- `update_disclaimer.py` - Configuration utility
